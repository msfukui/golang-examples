# 非公開（unexported）な機能を使ったテスト

以下のサイトで解説されているテストのテクニックについて試してみる。

* Go Fridayこぼれ話：非公開（unexported）な機能を使ったテスト #golang - メルカリエンジニアリング

    https://engineering.mercari.com/blog/entry/2018-08-08-080000/

## 写経してみての感想

* テストのパッケージ名を分ける、という話は、public なコードに対するテストを書くことが一般的に強制される、という文脈でよい習慣だと感じた

* 一方で、紹介されているテクニックは、多用すると、以下のような保守性に悪影響を及ぼす副作用があるとも感じた

    * `export_test.go` でテスト用に公開している型、関数などをプロダクションコードとは別に意識する必要がある

        プロダクションコードに直接関係のない管理対象が増えて今後の保守でのブロッカーになりそう。

    * private に依存した、壊れやすいテストが増える

    * よくない設計でも歪にテストが書けてしまうことで、テストを書く目的の一つである、よい設計へのリファクタリングに繋がらない

* ので、テクニックとしてはこのようなパターンは覚えておいてよいけれども、用法・容量を守って、多用しないような注意が必要であると理解した

* 直接関係ないけれど `httptest` のモックサーバーの利用方法を理解していなかったため、とても参考になった！
